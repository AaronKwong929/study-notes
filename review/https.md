# HTTPS

## 基本概念

使用 Secure Socket Layer(ssl) 或者 Transport Layer Security(TLS) 加密通信内容

SSL3.0（已弃用），TLS1.2（主流使用）

功能实现依靠：`非对称加密`, `对称加密`, `散列算法`

SSL 在应用层（表示层 - 算 7 层的话）

## HTTPS 请求

1. 客户端请求 https 站点

2. 服务端返回公钥证书(B 发送 `B公`回到 A)

3. 客户端验证公钥证书(数字证书)

   - 3.1. 失败：弹出警告

   - 3.2. 成功：伪随机数生成会话密钥，使用 `B公` 加密会话密钥，发送给服务端

4. 服务端用 `B私`解密，获得 `A私`

5. 然后服务端使用 `A私`，对称加密报文，发送给 A

6. A 也用 `A私` 进行解密

## HTTP 和 HTTPS 对比

|          |  HTTP  |               HTTPS                |
| :------: | :----: | :--------------------------------: |
|   端口   |   80   |                443                 |
|   特点   | 单元格 | 更安全，利于 SEO，有站点安全锁提示 |
| OSI 7 层 | 传输层 |               表示层               |
|   4 层   | 传输层 |               应用层               |
|   成本   |   低   |       高(证书选择/购买/部署)       |

## 握手过程 基于 tcp 三次再额外加 4 次

1. 建立安全能力：协议版本，会话 ID，密码构建，压缩方法，随机数

2. 服务器发送证书，密钥交换，证书请求，发送请求（和响应阶段结束信号

3. 如果有证书请求客户端发送此证书 之后客户端发送密钥交换数据 也可以发送证书验证消息

4. 变更密码构件和结束握手协议

## 数字签名

生成：`一段文本 --hash函数--> 消息摘要 --私钥加密--> 数字签名`

校验：

1. `发送者公钥解密(A钥解密) --> 消息摘要1`

2. `原文 --hash函数--> 消息摘要2`

3. 比对摘要 1 和 2

确认消息来源于发送方(而非中间人)

确认消息完整性(未经篡改)
